<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Mapa Interactivo de Esperanza de Vida Promedio (2019-2022)</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f7fb;
            margin: 0;
            padding: 20px;
            display: flex;
        }
        .container {
            display: flex;
            width: 100%;
            max-width: 1400px;
            margin: auto;
        }
        .map-container {
            flex: 3;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .sidebar {
            flex: 1;
            background: #e8f0fe;
            padding: 20px;
            margin-left: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #2a3f5f;
            font-size: 28px;
            margin-bottom: 20px;
        }
        .filter-container {
            margin-bottom: 20px;
        }
        .filter-container label {
            font-weight: bold;
            color: #2a3f5f;
            margin-right: 10px;
        }
        .filter-container input {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 5px;
            width: 100px;
        }
        .stats {
            font-size: 14px;
            color: #2a3f5f;
        }
        .stats p {
            margin: 10px 0;
        }
        .plotly-graph-div {
            width: 100%;
            height: 600px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="map-container">
            <h1>Mapa Interactivo de Esperanza de Vida Promedio por País (2019-2022)</h1>
            <div id="d2f68bd9-34b8-4cf4-9879-3922f41ef0cc" class="plotly-graph-div"></div>
        </div>
        <div class="sidebar">
            <h2>Estadísticas Globales</h2>
            <div class="stats">
                <p><strong>Promedio Mundial:</strong> 73.4 años</p>
                <p><strong>Máxima Esperanza de Vida:</strong> Japón (84.7 años)</p>
                <p><strong>Mínima Esperanza de Vida:</strong> Sudán del Sur (58.6 años)</p>
            </div>
            <div class="filter-container">
                <label for="lifeExpectancyFilter">Filtrar por Esperanza de Vida (años):</label>
                <input type="number" id="lifeExpectancyFilter" min="50" max="90" value="50" step="1">
            </div>
        </div>
    </div>

    <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
    </script>
    <script type="text/javascript" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
    <script type="text/javascript">
        window.PLOTLYENV = window.PLOTLYENV || {};
        if (document.getElementById("d2f68bd9-34b8-4cf4-9879-3922f41ef0cc")) {
            const originalData = [{
                "coloraxis": "coloraxis",
                "geo": "geo",
                "hovertemplate": "<b>%{hovertext}</b><br><br>Código de País=%{location}<br>Esperanza de Vida Promedio (años)=%{z}<extra></extra>",
                "hovertext": ["Fiji", "Tanzania", "W. Sahara", "Canadá", "Estados Unidos", "Kazajistán", "Uzbekistán", "Papúa Nueva Guinea", "Indonesia", "Argentina", "Chile", "Rep. Dem. Congo", "Somalia", "Kenia", "Sudán", "Chad", "Haití", "Rep. Dominicana", "Rusia", "Bahamas", "Islas Malvinas", "Groenlandia", "Tierras Australes Francesas", "Timor-Leste", "Sudáfrica", "Lesoto", "México", "Uruguay", "Brasil", "Bolivia", "Perú", "Colombia", "Panamá", "Costa Rica", "Nicaragua", "Honduras", "El Salvador", "Guatemala", "Belice", "Venezuela", "Guyana", "Surinam", "Ecuador", "Puerto Rico", "Jamaica", "Cuba", "Zimbabue", "Botsuana", "Namibia", "Senegal", "Malí", "Mauritania", "Benín", "Níger", "Nigeria", "Camerún", "Togo", "Ghana", "Costa de Marfil", "Guinea", "Guinea-Bisáu", "Liberia", "Sierra Leona", "Burkina Faso", "Rep. Centroafricana", "Congo", "Gabón", "Guinea Ecuatorial", "Zambia", "Malaui", "Mozambique", "Esuatini", "Angola", "Burundi", "Israel", "Líbano", "Madagascar", "Palestina", "Gambia", "Túnez", "Argelia", "Jordania", "Emiratos Árabes Unidos", "Catar", "Kuwait", "Irak", "Omán", "Vanuatu", "Camboya", "Tailandia", "Laos", "Myanmar", "Vietnam", "Corea del Norte", "Corea del Sur", "Mongolia", "India", "Bangladés", "Bután", "Nepal", "Pakistán", "Afganistán", "Tayikistán", "Kirguistán", "Turkmenistán", "Irán", "Siria", "Armenia", "Suecia", "Bielorrusia", "Ucrania", "Polonia", "Austria", "Hungría", "Moldova", "Rumania", "Lituania", "Letonia", "Estonia", "Alemania", "Bulgaria", "Grecia", "Turquía", "Albania", "Croacia", "Suiza", "Luxemburgo", "Bélgica", "Países Bajos", "Portugal", "España", "Irlanda", "Nueva Caledonia", "Islas Salomón", "Nueva Zelanda", "Australia", "Sri Lanka", "China", "Taiwán", "Italia", "Dinamarca", "Reino Unido", "Islandia", "Azerbaiyán", "Georgia", "Filipinas", "Malasia", "Brunéi", "Eslovenia", "Finlandia", "Eslovaquia", "Chequia", "Eritrea", "Japón", "Paraguay", "Yemen", "Arabia Saudí", "Antártida", "Chipre", "Marruecos", "Egipto", "Libia", "Etiopía", "Yibuti", "Uganda", "Ruanda", "Bosnia y Herzegovina", "Macedonia del Norte", "Serbia", "Montenegro", "Trinidad y Tobago", "Sudán del Sur"],
                "locations": ["FJI", "TZA", "ESH", "CAN", "USA", "KAZ", "UZB", "PNG", "IDN", "ARG", "CHL", "COD", "SOM", "KEN", "SDN", "TCD", "HTI", "DOM", "RUS", "BHS", "FLK", "GRL", "ATF", "TLS", "ZAF", "LSO", "MEX", "URY", "BRA", "BOL", "PER", "COL", "PAN", "CRI", "NIC", "HND", "SLV", "GTM", "BLZ", "VEN", "GUY", "SUR", "ECU", "PRI", "JAM", "CUB", "ZWE", "BWA", "NAM", "SEN", "MLI", "MRT", "BEN", "NER", "NGA", "CMR", "TGO", "GHA", "CIV", "GIN", "GNB", "LBR", "SLE", "BFA", "CAF", "COG", "GAB", "GNQ", "ZMB", "MWI", "MOZ", "SWZ", "AGO", "BDI", "ISR", "LBN", "MDG", "PSE", "GMB", "TUN", "DZA", "JOR", "ARE", "QAT", "KWT", "IRQ", "OMN", "VUT", "KHM", "THA", "LAO", "MMR", "VNM", "PRK", "KOR", "MNG", "IND", "BGD", "BTN", "NPL", "PAK", "AFG", "TJK", "KGZ", "TKM", "IRN", "SYR", "ARM", "SWE", "BLR", "UKR", "POL", "AUT", "HUN", "MDA", "ROU", "LTU", "LVA", "EST", "DEU", "BGR", "GRC", "TUR", "ALB", "HRV", "CHE", "LUX", "BEL", "NLD", "PRT", "ESP", "IRL", "NCL", "SLB", "NZL", "AUS", "LKA", "CHN", "TWN", "ITA", "DNK", "GBR", "ISL", "AZE", "GEO", "PHL", "MYS", "BRN", "SVN", "FIN", "SVK", "CZE", "ERI", "JPN", "PRY", "YEM", "SAU", "ATA", "CYP", "MAR", "EGY", "LBY", "ETH", "DJI", "UGA", "RWA", "BIH", "MKD", "SRB", "MNE", "TTO", "SSD"],
                "name": "",
                "z": {
                    "dtype": "f8",
                    "bdata": "2c73U+PzUECuR+F6FKZQQAAAAAAAAPh/6l6E7kVsVED5HYjfgVhTQOxRuB6FE1JATDeJQWDDUUCF61G4HmlQQHWTGARWMlFArkfhehQKU0Atsp3vp+JTQN9PjZdu3k1A6Pup8dINTEAzMzMzMyNPQJDC9ShcZVBAYOXQIttxSkAlBoGVQ+dPQLx0kxgEVFJAa1iehuXtUUDFILByaB1SQAAAAAAAAPh/b0bmZmTyUUAAAAAAAAD4f39qvHSTGFFADi2yne/nT0ACK4cW2d5KQK5H4XoUFlJARIts5/tVU0AxCKwcWnhSQGDl0CLbTVBAF9nO91N5UkBcj8L1KKBSQMZLN4lBOFNAmG4Sg8CQU0CJQWDl0GRSQMl2vp8a01FAc2iR7XzdUUAIrBxaZK1RQLbz/dR4A1JAcT0K16POUUAxCKwcWtRQQGDl0CLb1VFATmIQWDnQUkCyne+nxs9TQArXo3A9zFFAx0s3iUEwU0BSuB6F6yFOQHA9CtejIlBAgZVDi2xnTkD4U+Olm/hQQClcj8L1lE1AqvHSTWI0UECgGi/dJApOQOOlm8QgAE9ACKwcWmSDSkAtsp3vp3ZOQH9qvHSTpE5AL90kBoEJUEBI4XoUrntNQCGwcmiRnU1A+FPjpZsMTkBU46WbxHxOQMDKoUW2D05AbxKDwMrZTUB56SYxCEBLQBbZzvdTo09AqvHSTWKKUEAxCKwcWoROQO58PzVeBk9AI9v5fmq0T0Dwp8ZLNylOQNNNYhBYNU1AokW28/0IT0Dn+6nx0vFOQCtWpRJ1qlRANV66SQwoU0BYObTIdkxQQObQItv5iFJACKwcWmRrT0CF61G4HrVSQLByaJHtBlNAd76fGi+7UkBoke18P8lTQB+F61G4DlRA6iYxCKy4U0D4U+Olm6ZRQPYoXI/Cs1JAHVpkO9+RUUDEILByaIlRQPyp8dJNylNAhetRuB4bUUCPwvUoXKVQQGIQWDm0mlJA001iEFhVUkDoaFyOxs1UQEjhehSu+VFAYhBYObRAUUDP91PjpS1SQGIQWDm08FFAK4cW2c5bUUC+nxov3ZhQQHnpJjEIYE9A2c73U+ObUUCuSdmalPVRQCuHFtnORVFAYOXQItu1UkAzMzMzMwVSQN9PjZduUFJAk7cheRu6VECSWDe8qEJSQB6I34H4k1FAa1K2JmUzU0BG6F6E7lVUQKF7EboX4VJADAIrhxZpUUCQwfkYnJ9SQDsal6Nx0VJAaleidiWiUkC7F6F7EYJTQON6FK5HPVRA6VmYnoVpUkCkdiVqVzpUQBov3SQGQ1NAUI2XbhJZU0B8FqZnYWJTQPoYnI/B4VRAr0TtStSmVECblK1J2WJUQFLA/gTsZ1RA/Bicj8FZVECQwfkYnMdUQDwVq1OxqlRATJpjPtMVVEDb+X5qvJpRQAzOx+B8lFRAmpmZmZnJVEDC9ShcjxZTQHNoke18jVNAAAAAAAAA+H+0MD0L07NUQCVvQ/I2XFRAEb8D8TtIVEDwOxC/A7lUQHe+nxovrVFAx0s3iUEYUkCiRbbz/dZRQLbz/dR47VJAsp3vp8arUkDB/gTsT0BUQMjgfAzOb1RAbVK2JmUjU0AC9idgf5pTQLpJDAIruVBAEbkbkbsVVUBwPQrXo/hRQD4K16NwE1BAoBov3SRGU0AAAAAAAAD4f65H4XoUXlRA4XoUrkeTUkDP91PjpatRQMqhRbbzD1JAJAaBlUNdUEAZBFYOLV5PQFK4HoXrhU9APN9PjZemUEBs5/up8QBTQDM1K1OzqlJApmRtStaqUkDidyB+B+pSQF66SQwChVJA2c73U+O9S0A="
                },
                "type": "choropleth"
            }];

            let filteredData = JSON.parse(JSON.stringify(originalData));

            Plotly.newPlot(
                "d2f68bd9-34b8-4cf4-9879-3922f41ef0cc",
                filteredData,
                {
                    "template": {
                        "data": {
                            "histogram2dcontour": [{"type": "histogram2dcontour", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}],
                            "choropleth": [{"type": "choropleth", "colorbar": {"outlinewidth": 0, "ticks": ""}}],
                            "histogram2d": [{"type": "histogram2d", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}],
                            "heatmap": [{"type": "heatmap", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}],
                            "contourcarpet": [{"type": "contourcarpet", "colorbar": {"outlinewidth": 0, "ticks": ""}}],
                            "contour": [{"type": "contour", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}],
                            "surface": [{"type": "surface", "colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}],
                            "mesh3d": [{"type": "mesh3d", "colorbar": {"outlinewidth": 0, "ticks": ""}}],
                            "scatter": [{"fillpattern": {"fillmode": "overlay", "size": 10, "solidity": 0.2}, "type": "scatter"}],
                            "parcoords": [{"type": "parcoords", "line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}],
                            "scatterpolargl": [{"type": "scatterpolargl", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}],
                            "bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}, "pattern": {"fillmode": "overlay", "size": 10, "solidity": 0.2}}, "type": "bar"}],
                            "scattergeo": [{"type": "scattergeo", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}],
                            "scatterpolar": [{"type": "scatterpolar", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}],
                            "histogram": [{"marker": {"pattern": {"fillmode": "overlay", "size": 10, "solidity": 0.2}}, "type": "histogram"}],
                            "scattergl": [{"type": "scattergl", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}],
                            "scatter3d": [{"type": "scatter3d", "line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}],
                            "scattermap": [{"type": "scattermap", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}],
                            "scattermapbox": [{"type": "scattermapbox", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}],
                            "scatterternary": [{"type": "scatterternary", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}],
                            "scattercarpet": [{"type": "scattercarpet", "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}}],
                            "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}],
                            "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}],
                            "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}, "pattern": {"fillmode": "overlay", "size": 10, "solidity": 0.2}}, "type": "barpolar"}],
                            "pie": [{"automargin": true, "type": "pie"}]
                        },
                        "layout": {
                            "autotypenumbers": "strict",
                            "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"],
                            "font": {"color": "#2a3f5f"},
                            "hovermode": "closest",
                            "hoverlabel": {"align": "left"},
                            "paper_bgcolor": "white",
                            "plot_bgcolor": "#E5ECF6",
                            "polar": {"bgcolor": "#E5ECF6", "angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}},
                            "ternary": {"bgcolor": "#E5ECF6", "aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}},
                            "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}},
                            "colorscale": {
                                "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]],
                                "diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]]
                            },
                            "xaxis": {"gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "automargin": true, "zerolinewidth": 2},
                            "yaxis": {"gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "automargin": true, "zerolinewidth": 2},
                            "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white", "gridwidth": 2}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white", "gridwidth": 2}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white", "gridwidth": 2}},
                            "shapedefaults": {"line": {"color": "#2a3f5f"}},
                            "annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1},
                            "geo": {"bgcolor": "white", "landcolor": "#E5ECF6", "subunitcolor": "white", "showland": true, "showlakes": true, "lakecolor": "white"},
                            "title": {"x": 0.05},
                            "mapbox": {"style": "light"}
                        }
                    },
                    "geo": {
                        "domain": {"x": [0.0, 1.0], "y": [0.0, 1.0]},
                        "center": {},
                        "visible": true,
                        "showcountries": true,
                        "countrycolor": "Black"
                    },
                    "coloraxis": {
                        "colorbar": {"title": {"text": "Esperanza de Vida Promedio (años)"}},
                        "colorscale": [[0.0, "#440154"], [0.1111111111111111, "#482878"], [0.2222222222222222, "#3e4989"], [0.3333333333333333, "#31688e"], [0.4444444444444444, "#26828e"], [0.5555555555555556, "#1f9e89"], [0.6666666666666666, "#35b779"], [0.7777777777777778, "#6ece58"], [0.8888888888888888, "#b5de2b"], [1.0, "#fde725"]]
                    },
                    "legend": {"tracegroupgap": 0},
                    "title": {"text": "", "x": 0.5},
                    "margin": {"r": 0, "t": 40, "l": 0, "b": 0}
                },
                {"responsive": true}
            );

            // Add filter functionality
            document.getElementById('lifeExpectancyFilter').addEventListener('input', function() {
                const threshold = parseFloat(this.value);
                const zValues = new Float64Array(new Uint8Array([...atob(originalData[0].z.bdata).split('').map(c => c.charCodeAt(0))]).buffer);
                filteredData[0].locations = originalData[0].locations.filter((_, i) => zValues[i] >= threshold);
                filteredData[0].hovertext = originalData[0].hovertext.filter((_, i) => zValues[i] >= threshold);
                filteredData[0].z.bdata = btoa(new Uint8Array(new Float64Array(zValues.filter(val => val >= threshold)).buffer).reduce((str, byte) => str + String.fromCharCode(byte), ''));

                Plotly.react("d2f68bd9-34b8-4cf4-9879-3922f41ef0cc", filteredData);
            });
        }
    </script>
</body>
</html>